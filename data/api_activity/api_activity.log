2025-02-22 22:15:03,659 - INFO - Starting API activity event generation and upload
2025-02-22 22:15:03,794 - INFO - PUT https://52.66.102.200:9200/_template/ocsf-1.1.0-6003-api_activity [status:200 request:0.134s]
2025-02-22 22:15:03,794 - INFO - Successfully created index template: ocsf-1.1.0-6003-api_activity
2025-02-22 22:15:03,795 - INFO - Processing batch 1
2025-02-22 22:15:03,918 - INFO - POST https://52.66.102.200:9200/_bulk [status:200 request:0.123s]
2025-02-22 22:15:03,919 - ERROR - Failed items in batch 1: [{'index': {'_index': 'ocsf-1.1.0-6003-api_activity-2025.02.22-000000', '_id': 'oaOMLpUB_Ky1zrQ_VTu7', 'status': 400, 'error': {'type': 'mapper_parsing_exception', 'reason': "failed to parse field [api.response.error] of type [keyword] in document with id 'oaOMLpUB_Ky1zrQ_VTu7'. Preview of field's value: '{code=500, details=Failed to post /api/v1/resources, message=Internal Server Error}'", 'caused_by': {'type': 'illegal_state_exception', 'reason': "Can't get text on a START_OBJECT at 1:514"}}}}, {'index': {'_index': 'ocsf-1.1.0-6003-api_activity-2025.02.22-000000', '_id': 'oqOMLpUB_Ky1zrQ_VTu7', 'status': 400, 'error': {'type': 'mapper_parsing_exception', 'reason': "failed to parse field [api.response.error] of type [keyword] in document with id 'oqOMLpUB_Ky1zrQ_VTu7'. Preview of field's value: '{code=500, details=Failed to put /api/v1/users, message=Internal Server Error}'", 'caused_by': {'type': 'illegal_state_exception', 'reason': "Can't get text on a START_OBJECT at 1:509"}}}}, {'index': {'_index': 'ocsf-1.1.0-6003-api_activity-2025.02.22-000000', '_id': 'pKOMLpUB_Ky1zrQ_VTu7', 'status': 400, 'error': {'type': 'mapper_parsing_exception', 'reason': "failed to parse field [api.response.error] of type [keyword] in document with id 'pKOMLpUB_Ky1zrQ_VTu7'. Preview of field's value: '{code=401, details=Failed to post /api/v2/data, message=Unauthorized}'", 'caused_by': {'type': 'illegal_state_exception', 'reason': "Can't get text on a START_OBJECT at 1:500"}}}}, {'index': {'_index': 'ocsf-1.1.0-6003-api_activity-2025.02.22-000000', '_id': 'paOMLpUB_Ky1zrQ_VTu7', 'status': 400, 'error': {'type': 'mapper_parsing_exception', 'reason': "failed to parse field [api.response.error] of type [keyword] in document with id 'paOMLpUB_Ky1zrQ_VTu7'. Preview of field's value: '{code=400, details=Failed to patch /api/v1/users, message=Bad Request}'", 'caused_by': {'type': 'illegal_state_exception', 'reason': "Can't get text on a START_OBJECT at 1:500"}}}}]
2025-02-22 22:15:03,919 - INFO - Batch 1: 1 successful, 4 failed
2025-02-22 22:15:03,919 - INFO - Processing batch 2
2025-02-22 22:15:03,952 - INFO - POST https://52.66.102.200:9200/_bulk [status:200 request:0.032s]
2025-02-22 22:15:03,953 - ERROR - Failed items in batch 2: [{'index': {'_index': 'ocsf-1.1.0-6003-api_activity-2025.02.22-000000', '_id': 'pqOMLpUB_Ky1zrQ_Vjs5', 'status': 400, 'error': {'type': 'mapper_parsing_exception', 'reason': "failed to parse field [api.response.error] of type [keyword] in document with id 'pqOMLpUB_Ky1zrQ_Vjs5'. Preview of field's value: '{code=404, details=Failed to delete /api/v1/events, message=Not Found}'", 'caused_by': {'type': 'illegal_state_exception', 'reason': "Can't get text on a START_OBJECT at 1:484"}}}}, {'index': {'_index': 'ocsf-1.1.0-6003-api_activity-2025.02.22-000000', '_id': 'p6OMLpUB_Ky1zrQ_Vjs5', 'status': 400, 'error': {'type': 'mapper_parsing_exception', 'reason': "failed to parse field [api.response.error] of type [keyword] in document with id 'p6OMLpUB_Ky1zrQ_Vjs5'. Preview of field's value: '{code=403, details=Failed to patch /api/v1/auth, message=Forbidden}'", 'caused_by': {'type': 'illegal_state_exception', 'reason': "Can't get text on a START_OBJECT at 1:496"}}}}, {'index': {'_index': 'ocsf-1.1.0-6003-api_activity-2025.02.22-000000', '_id': 'qKOMLpUB_Ky1zrQ_Vjs5', 'status': 400, 'error': {'type': 'mapper_parsing_exception', 'reason': "failed to parse field [api.response.error] of type [keyword] in document with id 'qKOMLpUB_Ky1zrQ_Vjs5'. Preview of field's value: '{code=404, details=Failed to post /api/v1/users, message=Not Found}'", 'caused_by': {'type': 'illegal_state_exception', 'reason': "Can't get text on a START_OBJECT at 1:497"}}}}, {'index': {'_index': 'ocsf-1.1.0-6003-api_activity-2025.02.22-000000', '_id': 'qaOMLpUB_Ky1zrQ_Vjs5', 'status': 400, 'error': {'type': 'mapper_parsing_exception', 'reason': "failed to parse field [api.response.error] of type [keyword] in document with id 'qaOMLpUB_Ky1zrQ_Vjs5'. Preview of field's value: '{code=404, details=Failed to post /api/v2/metrics, message=Not Found}'", 'caused_by': {'type': 'illegal_state_exception', 'reason': "Can't get text on a START_OBJECT at 1:499"}}}}]
2025-02-22 22:15:03,953 - INFO - Batch 2: 1 successful, 4 failed
2025-02-22 22:15:03,953 - INFO - ==================================================
2025-02-22 22:15:03,953 - INFO - Upload complete to index: ocsf-1.1.0-6003-api_activity-2025.02.22-000000
2025-02-22 22:15:03,953 - INFO - Total events processed: 10
2025-02-22 22:15:03,953 - INFO - Successfully uploaded: 2
2025-02-22 22:15:03,953 - INFO - Failed uploads: 8
2025-02-22 22:15:03,953 - INFO - Success rate: 20.00%
2025-02-22 22:15:03,953 - INFO - ==================================================
